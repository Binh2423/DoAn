@model DoAn2.ViewModels.ComputerViewModel

@foreach (var item in Model.MayTinhs)
{
    <div class="col mb-5">
        <div class="card h-100">
            <!-- Product image-->
            <img class="card-img-top" src="~/images/@item.HinhAnh" alt="..." height="200px" width="300px" />
            <!-- Product details-->
            <div class="card-body p-4">
                <div class="text-center">
                    <!-- Product name-->
                    <h5 class="fw-bolder">@item.TenMay</h5>
                    <span>@String.Format(System.Globalization.CultureInfo.GetCultureInfo("vi-VN"), "{0:c}", item.Gia)</span>
                </div>
            </div>
            <!-- Product actions-->
            <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                <div class="text-center">
                    <a class="btn btn-outline-dark mt-auto" onclick="confirmDelete('@item.IdMay')">
                        <i class="fa-solid fa-trash"></i>Delete
                    </a>
                </div>

                <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                    <div class="text-center">
                        @if (item.BiHong == false)
                        {
                            @if (item.TrangThai == false)
                            {
                                <a class="btn btn-outline-dark mt-auto" onclick="confirmRent('@item.IdMay')">
                                    Thuê Máy
                                </a>
                                <a class="btn btn-outline-dark mt-auto" onclick="confirmEdit('@item.IdMay')">
                                    Phá máy
                                </a>
                            }
                            else
                            {
                                <a class="btn btn-outline-dark mt-auto" onclick="confirmPay('@item.IdMay')">
                                    Trả Máy
                                </a>
                            }

                        }
                        else
                        {
                            <a class="btn btn-outline-dark mt-auto" onclick="confirmEdit('@item.IdMay')">
                                Sửa máy
                            </a>
                        }


                    </div>
                </div>

            </div>
        </div>
    </div>
}

<script>
    function confirmDelete(IdMay) {
        if (confirm("Are you sure you want to delete this item?")) {
            $.ajax({
                url: '/Computer/Delete',
                type: 'POST',
                data: { IdMay: IdMay },
                success: function (response) {
                    if (response.success) {
                        // Hiển thị thông báo xóa thành công
                        alert('Item deleted successfully.');
                        // Reload page or update UI as needed
                        location.reload();
                    } else {
                        // Hiển thị thông báo lỗi nếu có
                        alert('Failed to delete item: ' + response.error);
                    }
                },
                error: function (xhr, status, error) {
                    // Hiển thị thông báo lỗi nếu có
                    alert('Error: ' + error);
                }
            });
        }
    };

    function confirmRent(IdMay) {
        if (confirm("Bạn có muốn thuê máy này không ?")) {
            $.ajax({
                url: '/Computer/ThueMay',
                type: 'POST',
                data: { IdMay: IdMay },
                success: function (response) {
                    if (response.success) {
                        // Hiển thị thông báo thuê máy thành công
                        alert('Đã Thuê Máy Thành Công');
                        // Reload page or update UI as needed
                        location.reload();
                    } else {
                        // Hiển thị thông báo lỗi nếu có
                        alert('Failed to rent item: ' + response.error);
                    }
                },
                error: function (xhr, status, error) {
                    // Hiển thị thông báo lỗi nếu có
                    alert('Error: ' + error);
                }
            });
        }
    };
    function confirmPay(IdMay) {
        if (confirm("Bạn có muốn trả máy này không ?")) {
            $.ajax({
                url: '/Computer/TraMay',
                type: 'POST',
                data: { IdMay: IdMay },
                success: function (response) {
                    if (response.success) {
                        // Hiển thị thông báo thuê máy thành công
                        alert('Đã Trả Máy Thành Công');
                        // Reload page or update UI as needed
                        location.reload();
                    } else {
                        // Hiển thị thông báo lỗi nếu có
                        alert('Failed to rent item: ' + response.error);
                    }
                },
                error: function (xhr, status, error) {
                    // Hiển thị thông báo lỗi nếu có
                    alert('Error: ' + error);
                }
            });
        }
    };

    function confirmEdit(IdMay) {
        $.ajax({
            url: '/Computer/Edit',
            type: 'POST',
            data: { IdMay: IdMay },
            success: function (response) {
                if (response.success) {
                    location.reload();
                } else {
                    // Hiển thị thông báo lỗi nếu có
                    alert('Failed to rent item: ' + response.error);
                }
            },
            error: function (xhr, status, error) {
                // Hiển thị thông báo lỗi nếu có
                alert('Error: ' + error);
            }
        });
    };





</script>


